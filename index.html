<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gacha Time</title>
    <style>
        table {
            border-collapse: collapse;
            width: 500px;
            margin: 50px auto;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }
        .time-box {
            border: 1px solid black;
            padding: 10px;
            width: 150px;
            margin: 0 auto;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
        }
        .checkbox {
            cursor: pointer;
        }
    </style>
    <style>
        /* Style to make the image smaller */
        .small-img {
            width: 50px; /* Adjust the width as needed */
            height: auto; /* Maintain aspect ratio */
        }
    </style>
</head>
<body>
    <h1>Gacha Time</h1>
    <div class="time-box">
        Local Time: <span id="local-time"></span>
    </div>
    <table>
        <tr>
            <th>Image</th>
            <th>Time</th>
            <th>Reset Time</th>
            <th>Time Left to Reset</th>
            <th>ToDo List</th>
            <th>Image</th>
            <th>Time</th>
            <th>Reset Time</th>
            <th>Time Left to Reset</th>
            <th>ToDo List</th>
        </tr>
        <tr>
            <th><img src="BlueArchive.ico" alt="Blue Archive" class="small-img"></th>       
            <td>Blue Archive</td>
            <td>02:00</td>
            <td id="time-left-BlueArchive"></td>
            <td><input type="checkbox" id="checkbox1"></td>
            <th><img src="FGO.ico" alt="FGO" class="small-img"></th>
            <td>FGO</td>
            <td>11:00</td>
            <td id="time-left-FGO"></td>
            <td><input type="checkbox" id="checkbox5"></td>
        </tr>
        <tr>
            <th><img src="Nikke.ico" alt="Nikke" class="small-img"></th>
            <td>Nikke</td>
            <td>03:00</td>
            <td id="time-left-Nikke"></td>
            <td><input type="checkbox" id="checkbox2"></td>
            <th><img src="PGR.ico" alt="PGR" class="small-img"></th>
            <td>PGR</td>
            <td>14:00</td>
            <td id="time-left-PGR"></td>
            <td><input type="checkbox" id="checkbox6"></td>
        </tr>
        <tr>
            <th><img src="SnowBreak.ico" alt="SnowBreak" class="small-img"></th>
            <td>SnowBreak</td>
            <td>03:00</td>
            <td id="time-left-SnowBreak"></td>
            <td><input type="checkbox" id="checkbox3"></td>
            <th><img src="Arknight.ico" alt="Arknight" class="small-img"></th>
            <td>Arknight</td>
            <td>18:00</td>
            <td id="time-left-Arknight"></td>
            <td><input type="checkbox" id="checkbox7"></td>
        </tr>
        <tr>
            <th><img src="CounterSide.ico" alt="CounterSide" class="small-img"></th>
            <td>CounterSide</td>
            <td>04:00</td>
            <td id="time-left-CounterSide"></td>
            <td><input type="checkbox" id="checkbox4"></td>
            <th><img src="AetherGazer.ico" alt="Aether Gazer" class="small-img"></th>
            <td>Aether Gazer</td>
            <td>19:00</td>
            <td id="time-left-AetherGazer"></td>
            <td><input type="checkbox" id="checkbox8"></td>
        </tr>
    </table>
    
    <button onclick="saveCheckboxStates()">Save</button>

    <script>
        function saveCheckboxStates() {
            const checkboxStates = {
                checkbox1: document.getElementById("checkbox1").checked,
                checkbox2: document.getElementById("checkbox2").checked,
                checkbox3: document.getElementById("checkbox3").checked,
                checkbox4: document.getElementById("checkbox4").checked,
                checkbox5: document.getElementById("checkbox5").checked,
                checkbox6: document.getElementById("checkbox6").checked,
                checkbox7: document.getElementById("checkbox7").checked,
                checkbox8: document.getElementById("checkbox8").checked,
            };
            
            const now = new Date();
            const gmt7Midnight = new Date(now.getTime() + (3600000 * 7)); // Convert local time to GMT+7
            gmt7Midnight.setHours(0, 0, 0, 0); // Set time to 00:00:00 GMT+7

            // Calculate the time difference between now and 00:00 GMT+7
            const timeUntilMidnight = gmt7Midnight.getTime() - now.getTime();

            // Schedule the function to run again at 00:00 GMT+7
            setTimeout(saveCheckboxStates, timeUntilMidnight);

            const accessToken = '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';
            const repoOwner = 'hanifnurw';
            const repoName = 'gachatime';
            const filePath = 'path/to/gachacheckbox.json'; // File path to save checkbox states
            
            const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`;
            fetch(apiUrl, {
                method: 'PUT',
                headers: {
                    'Authorization': `token ${accessToken}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    message: 'Update checkbox states',
                    content: btoa(JSON.stringify(checkboxStates)) // Encode content to base64
                })
            })
            .then(response => {
                if (response.ok) {
                    alert('Checkbox states saved successfully!');
                } else {
                    alert('Failed to save checkbox states.');
                    console.error('Error:', response.statusText);
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
        

        function updateTime() {
            var now = new Date();
            var hours = now.getHours();
            var minutes = now.getMinutes();
            var seconds = now.getSeconds();
            var timeString = hours.toString().padStart(2, '0') + ":" + minutes.toString().padStart(2, '0') + ":" + seconds.toString().padStart(2, '0');
            document.getElementById("local-time").textContent = timeString;

            // For Blue Archive
            var resetTimeBlueArchive = new Date();
            resetTimeBlueArchive.setHours(2, 0, 0, 0); // Set to 11:00 AM
            if (resetTimeBlueArchive < now) {
                resetTimeBlueArchive.setDate(resetTimeBlueArchive.getDate() + 1); // If already past today's reset time, set to tomorrow
            }
            var timeDifferenceBlueArchive = resetTimeBlueArchive.getTime() - now.getTime();
            setTimeLeft("time-left-BlueArchive", timeDifferenceBlueArchive);

            // For Nikke
            var resetTimeNikke = new Date();
            resetTimeNikke.setHours(3, 0, 0, 0); // Set to 11:00 AM
            if (resetTimeNikke < now) {
                resetTimeNikke.setDate(resetTimeNikke.getDate() + 1); // If already past today's reset time, set to tomorrow
            }
            var timeDifferenceNikke = resetTimeNikke.getTime() - now.getTime();
            setTimeLeft("time-left-Nikke", timeDifferenceNikke);

            // For SnowBreak
            var resetTimeSnowBreak = new Date();
            resetTimeSnowBreak.setHours(3, 0, 0, 0); // Set to 11:00 AM
            if (resetTimeSnowBreak < now) {
                resetTimeSnowBreak.setDate(resetTimeSnowBreak.getDate() + 1); // If already past today's reset time, set to tomorrow
            }
            var timeDifferenceSnowBreak = resetTimeSnowBreak.getTime() - now.getTime();
            setTimeLeft("time-left-SnowBreak", timeDifferenceSnowBreak);

            // For CounterSide
            var resetTimeCounterSide = new Date();
            resetTimeCounterSide.setHours(4, 0, 0, 0); // Set to 11:00 AM
            if (resetTimeCounterSide < now) {
                resetTimeCounterSide.setDate(resetTimeCounterSide.getDate() + 1); // If already past today's reset time, set to tomorrow
            }
            var timeDifferenceCounterSide = resetTimeCounterSide.getTime() - now.getTime();
            setTimeLeft("time-left-CounterSide", timeDifferenceCounterSide);

            // For FGO
            var resetTimeFGO = new Date();
            resetTimeFGO.setHours(11, 0, 0, 0); // Set to 11:00 AM
            if (resetTimeFGO < now) {
                resetTimeFGO.setDate(resetTimeFGO.getDate() + 1); // If already past today's reset time, set to tomorrow
            }
            var timeDifferenceFGO = resetTimeFGO.getTime() - now.getTime();
            setTimeLeft("time-left-FGO", timeDifferenceFGO);

            // For PGR
            var resetTimePGR = new Date();
            resetTimePGR.setHours(14, 0, 0, 0); // Set to 11:00 AM
            if (resetTimePGR < now) {
                resetTimePGR.setDate(resetTimePGR.getDate() + 1); // If already past today's reset time, set to tomorrow
            }
            var timeDifferencePGR = resetTimePGR.getTime() - now.getTime();
            setTimeLeft("time-left-PGR", timeDifferencePGR);
            
            // For Arknight
            var resetTimeArknight = new Date();
            resetTimeArknight.setHours(18, 0, 0, 0); // Set to 11:00 AM
            if (resetTimeArknight < now) {
                resetTimeArknight.setDate(resetTimeArknight.getDate() + 1); // If already past today's reset time, set to tomorrow
            }
            var timeDifferenceArknight = resetTimeArknight.getTime() - now.getTime();
            setTimeLeft("time-left-Arknight", timeDifferenceArknight);

            // For Aether Gazer
            var resetTimeAetherGazer = new Date();
            resetTimeAetherGazer.setHours(19, 0, 0, 0); // Set to 7:00 PM
            if (resetTimeAetherGazer < now) {
                resetTimeAetherGazer.setDate(resetTimeAetherGazer.getDate() + 1); // If already past today's reset time, set to tomorrow
            }
            var timeDifferenceAetherGazer = resetTimeAetherGazer.getTime() - now.getTime();
            setTimeLeft("time-left-AetherGazer", timeDifferenceAetherGazer);
        }

        function setTimeLeft(elementId, timeDifference) {
            var hoursRemaining = Math.floor(timeDifference / (1000 * 60 * 60));
            timeDifference -= hoursRemaining * (1000 * 60 * 60);
            var minutesRemaining = Math.floor(timeDifference / (1000 * 60));
            timeDifference -= minutesRemaining * (1000 * 60);
            var secondsRemaining = Math.floor(timeDifference / 1000);

            var timeLeftString = hoursRemaining.toString().padStart(2, '0') + ":" + minutesRemaining.toString().padStart(2, '0') + ":" + secondsRemaining.toString().padStart(2, '0');
            document.getElementById(elementId).textContent = timeLeftString;
        }

        updateTime(); // Initial call to display time immediately
        setInterval(updateTime, 1000); // Update time every second
    </script>
</body>
</html>
